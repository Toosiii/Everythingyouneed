<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="data.js"></script>
    <link rel="stylesheet" href="styles.css">
    <title>Links</title>
</head>
<body class="bg-gray-100 dark:bg-gray-900 dark:text-white transition">

<!-- HEADER -->
<header class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4 flex justify-between items-center">
    <h1 class="text-2xl font-bold">Everything you need</h1>
    <select id="languageSelect" class="border p-2 rounded text-black dark:text-white dark:bg-gray-700" onchange="changeLanguage(this.value)">
        <option value="en">English</option>
        <option value="de">Deutsch</option>
    </select>
</header>

<div class="flex min-h-screen" style="height: calc(100vh - 65px);">

    <!-- SIDEBAR -->
    <aside class="w-64 bg-white dark:bg-gray-800 p-5 border-r border-gray-200 dark:border-gray-700">
        <h1 id="sidebarTitle" class="text-xl font-bold mb-4">Topics</h1>
        <select id="topicsDropdown" class="w-full border p-2 rounded text-black dark:text-white dark:bg-gray-700" onchange="selectTopic(this.value)">
            <option value="">Select a topic...</option>
        </select>
        
        <!-- GAMES CATEGORIES -->
        <div id="gamesCategory" style="display: none; margin-top: 8px;">
            <h3 id="gamesCategoryTitle" class="text-lg font-semibold mt-4 mb-2">Games</h3>
            <div id="gamesList" class="flex flex-col gap-1"></div>
        </div>
    </aside>

    <!-- CONTENT -->
    <main class="flex-1 p-8 flex flex-col">

        <div id="landingPage" class="w-full">
            <div class="landing-container dark:bg-gradient-to-br dark:from-slate-900 dark:to-slate-800">
                <div class="landing-content">
                    <h2 id="landingTitle" class="landing-title">Everything you need</h2>
                    <p id="landingSubtitle" class="landing-subtitle">Select a topic from the list on the left to get started</p>
                    
                    <!-- Features Grid -->
                    <div class="features-grid">
                        <div class="feature-card">
                            <div class="feature-icon">ðŸŽ¬</div>
                            <div class="feature-title" id="featureTitle1">Live TV & Streaming</div>
                            <div class="feature-description" id="featureDesc1">Browse through curated links for movies, series, and live TV streams</div>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">ðŸŽ®</div>
                            <div class="feature-title" id="featureTitle2">Games</div>
                            <div class="feature-description" id="featureDesc2">Find resources for your favorite games like Minecraft, Valorant, and more</div>
                        </div>
                        
                        <div class="feature-card">
                            <div class="feature-icon">ðŸ’»</div>
                            <div class="feature-title" id="featureTitle3">Learning & Tools</div>
                            <div class="feature-description" id="featureDesc3">Access educational resources and programming tools all in one place</div>
                        </div>
                    </div>

                    <!-- Stats Section -->
                    <div class="stats-section">
                        <div class="stat">
                            <span class="stat-number">4</span>
                            <span class="stat-label" id="statTopics">Topics</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number" id="totalLinks">15+</span>
                            <span class="stat-label" id="statLinks">Links</span>
                        </div>
                        <div class="stat">
                            <span class="stat-number">2</span>
                            <span class="stat-label" id="statLanguages">Languages</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="topicContent" style="display: none;">
            <h2 id="topicTitle" class="text-3xl font-bold mb-4"></h2>

            <!-- SUCHFELD -->
            <form class="mb-4 flex gap-2" onsubmit="return false;">
                <input id="searchInput" name="search" placeholder="Search..."
                       class="border p-2 rounded text-black w-64"
                       onkeyup="filterLinks()">
                <button class="bg-blue-500 text-white px-4 rounded" onclick="filterLinks()">
                    OK
                </button>
            </form>

            <!-- TAGS -->
            <div id="tagsList" class="mb-4 flex gap-2 flex-wrap"></div>

            <!-- LINKS -->
            <div id="linksList" class="grid grid-cols-1 md:grid-cols-3 gap-4"></div>
        </div>

    </main>
</div>

<script>
let currentTopicId = null;
let selectedTag = null;
let selectedGame = null;
let currentLanguage = 'en';

// Translation function
function trans(key) {
    return allData.translations[currentLanguage]?.[key] || key;
}

// Change language
function changeLanguage(lang) {
    currentLanguage = lang;
    document.documentElement.lang = lang;
    document.getElementById('languageSelect').value = lang;
    document.getElementById('sidebarTitle').textContent = trans('topics');
    document.getElementById('gamesCategoryTitle').textContent = trans('games');
    document.getElementById('landingTitle').textContent = trans('everythingYouNeed');
    document.getElementById('landingSubtitle').textContent = trans('startBrowsing');
    document.getElementById('searchInput').placeholder = trans('search');
    
    // Update feature cards
    document.getElementById('featureTitle1').textContent = trans('featureTitle1');
    document.getElementById('featureDesc1').textContent = trans('featureDesc1');
    document.getElementById('featureTitle2').textContent = trans('featureTitle2');
    document.getElementById('featureDesc2').textContent = trans('featureDesc2');
    document.getElementById('featureTitle3').textContent = trans('featureTitle3');
    document.getElementById('featureDesc3').textContent = trans('featureDesc3');
    
    // Update stats
    document.getElementById('statTopics').textContent = trans('statTopics');
    document.getElementById('statLinks').textContent = trans('statLinks');
    document.getElementById('statLanguages').textContent = trans('statLanguages');
    
    // Update topics dropdown
    if (allData.topics) {
        const select = document.getElementById('topicsDropdown');
        select.innerHTML = `<option value="">${trans('selectTopic')}</option>`;
        allData.topics.forEach(topic => {
            const option = document.createElement('option');
            option.value = topic.id;
            option.textContent = topic.name;
            select.appendChild(option);
        });
    }
}

// Initialize and load
function loadData() {
    changeLanguage(currentLanguage);
    
    // Check URL params
    const params = new URLSearchParams(window.location.search);
    const topicParam = params.get('topic');
    const tagParam = params.get('tag');
    const searchParam = params.get('search');
    
    if (topicParam) {
        selectTopic(topicParam);
        if (tagParam) selectedTag = tagParam;
        if (searchParam) document.getElementById('searchInput').value = searchParam;
        filterLinks();
    }
}

// Render topics in dropdown
function renderTopics() {
    const topicsDropdown = document.getElementById('topicsDropdown');
    topicsDropdown.innerHTML = '<option value="">Select a topic...</option>';
    
    allData.topics?.forEach(topic => {
        const option = document.createElement('option');
        option.value = topic.id;
        option.textContent = topic.name;
        topicsDropdown.appendChild(option);
    });
}

// Select a topic
function selectTopic(topicId) {
    if (!topicId) {
        // Show landing page if no topic selected
        document.getElementById('landingPage').style.display = 'block';
        document.getElementById('topicContent').style.display = 'none';
        document.getElementById('gamesCategory').style.display = 'none';
        return;
    }
    
    currentTopicId = topicId;
    selectedTag = null;
    selectedGame = null;
    document.getElementById('searchInput').value = '';
    document.getElementById('topicsDropdown').value = topicId;
    
    const current = allData.topics?.find(t => t.id === topicId);
    if (!current) return;
    
    document.getElementById('landingPage').style.display = 'none';
    document.getElementById('topicContent').style.display = 'block';
    document.getElementById('topicTitle').textContent = current.name;
    
    // Show games category section only for Games topic
    const gamesCategorySection = document.getElementById('gamesCategory');
    if (topicId === 'Games') {
        gamesCategorySection.style.display = 'block';
        renderGameCategories(current);
    } else {
        gamesCategorySection.style.display = 'none';
    }
    
    renderTags(current);
    filterLinks();
    
    window.history.pushState(null, '', `?topic=${encodeURIComponent(topicId)}`);
}

// Render tags
function renderTags(topic) {
    const tagsList = document.getElementById('tagsList');
    tagsList.innerHTML = '';
    
    const allTags = {};
    topic.links?.forEach(link => {
        link.tags?.forEach(tag => {
            allTags[tag] = true;
        });
    });
    
    Object.keys(allTags).forEach(tag => {
        const a = document.createElement('a');
        a.href = '#';
        a.textContent = tag;
        a.className = 'px-2 py-1 bg-gray-300 dark:bg-gray-700 rounded text-sm cursor-pointer hover:bg-gray-400 dark:hover:bg-gray-600';
        a.onclick = (e) => {
            e.preventDefault();
            selectedTag = selectedTag === tag ? null : tag;
            window.history.pushState(null, '', `?topic=${currentTopicId}&tag=${selectedTag || ''}`);
            filterLinks();
        };
        tagsList.appendChild(a);
    });
}

// Render game categories in sidebar
function renderGameCategories(topic) {
    const gamesList = document.getElementById('gamesList');
    gamesList.innerHTML = '';
    
    const games = new Set();
    topic.links?.forEach(link => {
        if (link.game) {
            games.add(link.game);
        }
    });
    
    games.forEach(game => {
        const a = document.createElement('a');
        a.href = '#';
        a.textContent = game;
        a.className = 'px-3 py-2 rounded hover:bg-gray-200 dark:hover:bg-gray-700 cursor-pointer text-sm';
        a.onclick = (e) => {
            e.preventDefault();
            selectedGame = selectedGame === game ? null : game;
            filterLinks();
        };
        gamesList.appendChild(a);
    });
}

// Filter and display links
function filterLinks() {
    const current = allData.topics?.find(t => t.id === currentTopicId);
    if (!current) return;
    
    let links = current.links || [];
    const search = document.getElementById('searchInput').value.toLowerCase();
    
    // Search filter
    if (search) {
        links = links.filter(l =>
            l.title.toLowerCase().includes(search) ||
            l.description.toLowerCase().includes(search)
        );
    }
    
    // Tag filter
    if (selectedTag) {
        links = links.filter(l =>
            l.tags?.includes(selectedTag)
        );
    }
    
    // Game filter (for Games topic)
    if (selectedGame && currentTopicId === 'Games') {
        links = links.filter(l =>
            l.game === selectedGame
        );
    }
    
    renderLinks(links);
}

// Render links
function renderLinks(links) {
    const linksList = document.getElementById('linksList');
    linksList.innerHTML = '';
    
    links.forEach(link => {
        const div = document.createElement('div');
        div.className = 'bg-white dark:bg-gray-800 p-4 rounded-2xl shadow hover:shadow-lg hover:-translate-y-1 transition';
        
        const title = document.createElement('h3');
        title.className = 'font-semibold text-lg';
        title.textContent = link.title;
        
        const url = document.createElement('a');
        url.href = link.url;
        url.target = '_blank';
        url.className = 'text-blue-500 text-sm break-all';
        url.textContent = link.url;
        
        const desc = document.createElement('p');
        desc.className = 'text-gray-600 dark:text-gray-300 text-sm mt-1';
        desc.textContent = link.description;
        
        div.appendChild(title);
        div.appendChild(url);
        div.appendChild(desc);
        linksList.appendChild(div);
    });
}

// Dark mode always enabled
document.documentElement.classList.add('dark');

// Load everything on page load
window.addEventListener('DOMContentLoaded', loadData);
</script>

</body>
</html>
